<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- SEO 최적화를 위한 제목 및 메타 태그 -->
    <title>
      한국 연봉/월급 실수령액 계산기 | NetPayKorea - 4대보험 & 소득세 자동 계산
    </title>
    <meta
      name="description"
      content="NetPayKorea에서 한국 연봉 및 월급 실수령액을 간편하게 계산하세요. 4대 보험, 소득세, 지방소득세를 자동 반영하며, 여러 시나리오를 저장하고 비교할 수 있는 유일한 계산기입니다."
    />
    <meta
      name="keywords"
      content="실수령액 계산기, 연봉 실수령액, 월급 실수령액, 4대보험, 소득세, 지방소득세, 한국 급여 계산, 급여 시뮬레이션, 세금 계산기, net pay calculator korea"
    />
    <!-- 캐노니컬 URL 설정 (SEO에 중요) -->
    <link rel="canonical" href="https://netpaykorea.netlify.app/" />

    <!-- 파비콘 (SVG 형태로 HTML에 직접 포함) -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%233B82F6' d='M20 6h-4V4c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zM10 4h4v2h-4V4zm10 14H4V8h16v10zM9 13.5c0-.83.67-1.5 1.5-1.5h3c.83 0 1.5.67 1.5 1.5v3c0 .83-.67 1.5-1.5 1.5h-3c-.83 0-1.5-.67-1.5-1.5v-3z'/%3E%3C/svg%3E"
    />

    <!-- Tailwind CSS CDN (간단하고 반응형 디자인에 용이) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* 기본 폰트 및 배경색 설정 */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f0f2f5; /* 밝은 회색 배경 */
        color: #333;
      }
      /* 사용자 정의 스크롤바 (미적 향상) */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #e2e8f0;
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }
    </style>
  </head>
  <body
    class="min-h-screen flex flex-col items-center py-8 px-4 sm:px-6 lg:px-8"
  >
    <!-- 주요 콘텐츠 영역 -->
    <main
      class="w-full max-w-4xl bg-white rounded-lg shadow-xl p-6 sm:p-8 lg:p-10 mb-8"
    >
      <h1
        class="text-3xl sm:text-4xl font-extrabold text-center text-blue-700 mb-6 leading-tight"
      >
        한국 연봉/월급 실수령액 계산기
      </h1>
      <p class="text-center text-gray-600 mb-8 sm:mb-10 text-lg">
        대한민국 4대 보험 및 소득세를 반영한 정확한 실수령액을 간편하게
        확인하고,
        <strong class="text-blue-600">다양한 시나리오를 저장 및 비교</strong>해
        보세요!
      </p>

      <!-- 계산기 섹션 -->
      <section class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
        <div class="space-y-6">
          <h2
            class="text-2xl font-bold text-gray-800 border-b-2 border-blue-200 pb-3 mb-4"
          >
            입력 정보
          </h2>
          <div>
            <label
              for="annualSalary"
              class="block text-gray-700 text-sm font-semibold mb-2"
              >연봉 (세전, 원)</label
            >
            <input
              type="number"
              id="annualSalary"
              placeholder="예: 40000000"
              class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
              min="0"
              step="10000"
            />
          </div>
          <div>
            <label
              for="nonTaxableIncome"
              class="block text-gray-700 text-sm font-semibold mb-2"
              >비과세 소득 (월, 원)</label
            >
            <input
              type="number"
              id="nonTaxableIncome"
              value="200000"
              class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
              min="0"
              step="10000"
            />
            <p class="text-xs text-gray-500 mt-1">
              예: 식대 (월 20만원까지), 자가운전보조금 등. 비과세 항목은 세금이
              부과되지 않습니다.
            </p>
          </div>
          <div>
            <label
              for="dependents"
              class="block text-gray-700 text-sm font-semibold mb-2"
              >부양가족수 (본인 포함)</label
            >
            <input
              type="number"
              id="dependents"
              value="1"
              class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
              min="1"
              max="10"
            />
            <p class="text-xs text-gray-500 mt-1">
              소득세 계산 시 적용됩니다. 일반적으로 본인 포함입니다.
            </p>
          </div>
          <button
            id="calculateBtn"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 text-lg"
          >
            실수령액 계산하기
          </button>
        </div>

        <div class="space-y-6">
          <h2
            class="text-2xl font-bold text-gray-800 border-b-2 border-blue-200 pb-3 mb-4"
          >
            계산 결과 (월 기준)
          </h2>
          <div class="bg-blue-50 p-4 rounded-md shadow-inner">
            <p class="text-gray-700 text-sm mb-2">
              총 월 급여 (세전):
              <span
                id="displayMonthlyGross"
                class="font-bold text-base text-blue-800"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm mb-2">
              월 과세 대상 급여:
              <span
                id="displayMonthlyTaxable"
                class="font-bold text-base text-blue-800"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm">
              월 비과세 소득:
              <span
                id="displayMonthlyNonTaxable"
                class="font-bold text-base text-blue-800"
                >0원</span
              >
            </p>
          </div>

          <div class="bg-gray-50 p-4 rounded-md shadow-inner">
            <p class="text-gray-700 text-sm mb-2">
              국민연금:
              <span
                id="displayNationalPension"
                class="font-semibold text-base text-red-600"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm mb-2">
              건강보험:
              <span
                id="displayHealthInsurance"
                class="font-semibold text-base text-red-600"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm mb-2">
              장기요양보험:
              <span
                id="displayLongTermCare"
                class="font-semibold text-base text-red-600"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm mb-2">
              고용보험:
              <span
                id="displayEmploymentInsurance"
                class="font-semibold text-base text-red-600"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm mb-2">
              소득세:
              <span
                id="displayIncomeTax"
                class="font-semibold text-base text-red-600"
                >0원</span
              >
            </p>
            <p class="text-gray-700 text-sm">
              지방소득세:
              <span
                id="displayLocalIncomeTax"
                class="font-semibold text-base text-red-600"
                >0원</span
              >
            </p>
          </div>

          <div
            class="bg-green-100 p-4 rounded-md shadow-md border-l-4 border-green-500"
          >
            <p class="text-xl font-bold text-green-800">
              월 예상 실수령액:
              <span
                id="displayNetPay"
                class="text-3xl font-extrabold text-green-900"
                >0원</span
              >
            </p>
          </div>
        </div>
      </section>

      <!-- 시나리오 관리 섹션 (차별화 기능) -->
      <section class="mt-12 bg-gray-50 p-6 rounded-lg shadow-inner">
        <h2
          class="text-2xl font-bold text-gray-800 border-b-2 border-gray-200 pb-3 mb-4"
        >
          나의 시나리오 저장 및 비교
        </h2>
        <p class="text-gray-600 mb-4">
          현재 계산된 결과를 시나리오로 저장하고, 필요할 때 불러와 비교해
          보세요. 브라우저에 저장됩니다.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 mb-6">
          <input
            type="text"
            id="scenarioName"
            placeholder="시나리오 이름 (예: 현재 급여, 이직 제안)"
            class="flex-grow p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"
          />
          <button
            id="saveScenarioBtn"
            class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105"
          >
            시나리오 저장
          </button>
        </div>
        <div id="scenarioList" class="space-y-3">
          <!-- 시나리오 목록이 JavaScript를 통해 여기에 로드됩니다. -->
          <p class="text-gray-500 text-center" id="noScenariosMessage">
            저장된 시나리오가 없습니다.
          </p>
        </div>
      </section>

      <!-- 설명 및 SEO 콘텐츠 (GEO 최적화) -->
      <section class="mt-12 p-6 bg-blue-50 rounded-lg shadow-md">
        <h2
          class="text-2xl font-bold text-gray-800 border-b-2 border-blue-200 pb-3 mb-4"
        >
          NetPayKorea가 특별한 이유
        </h2>
        <p class="text-gray-700 mb-4 leading-relaxed">
          시중에 많은 연봉/월급 실수령액 계산기가 있지만, NetPayKorea는 여러분의
          <strong class="text-blue-600">복잡한 고민을 해결</strong>하기 위해
          태어났습니다. 단순히 한 번 계산하고 마는 것이 아니라,
          <strong class="text-blue-600">다양한 '가정'을 시나리오로 저장</strong
          >하여 '연봉이 5천만원으로 오르면 실수령액은 얼마일까?', '성과급
          1천만원을 받으면 세금은 얼마나 늘어날까?' 와 같은 질문에 대한 답을
          <strong class="text-blue-600">즉시 비교</strong>할 수 있습니다.
        </p>
        <p class="text-gray-700 mb-4 leading-relaxed">
          복잡한 세법이나 4대 보험 요율을 일일이 찾아볼 필요 없이, 필요한 정보를
          입력하기만 하면
          <strong class="text-blue-600"
            >가장 최신 기준을 반영하여 정확한 실수령액을 계산</strong
          >해 드립니다. 이 모든 기능은
          <strong class="text-blue-600"
            >여러분 브라우저의 로컬 저장소에 안전하게 보관</strong
          >되므로, 언제든지 다시 접속하여 중단했던 시점부터 이어서 사용할 수
          있습니다.
        </p>

        <h3
          class="text-xl font-bold text-gray-800 border-b border-gray-200 pb-2 mb-3 mt-6"
        >
          4대 보험 및 세금 안내 (2024년 기준)
        </h3>
        <p class="text-gray-700 mb-2 leading-relaxed">
          ✅ <strong class="text-red-600">국민연금:</strong> 월 과세소득의 4.5%
          (사업장 가입자의 경우 사용자 4.5% + 본인 4.5% = 총 9%. 계산기는 본인
          부담분만 적용) <br /><span class="text-sm text-gray-500"
            >※ 기준소득월액 상한액(2024년 590만원)이 있어 일정 급여 이상은
            동일하게 적용됩니다.</span
          >
        </p>
        <p class="text-gray-700 mb-2 leading-relaxed">
          ✅ <strong class="text-red-600">건강보험:</strong> 월 과세소득의
          3.545% (사업장 가입자의 경우 사용자 3.545% + 본인 3.545% = 총 7.09%)
        </p>
        <p class="text-gray-700 mb-2 leading-relaxed">
          ✅ <strong class="text-red-600">장기요양보험:</strong> 건강보험료의
          12.95% (건강보험료에 비례하여 부과)
        </p>
        <p class="text-gray-700 mb-2 leading-relaxed">
          ✅ <strong class="text-red-600">고용보험:</strong> 월 과세소득의 0.8%
          (실업급여 보험료율, 사업장 가입자 기준)
        </p>
        <p class="text-gray-700 mb-2 leading-relaxed">
          ✅ <strong class="text-red-600">소득세:</strong> 국세청 간이세액표
          기준 적용 (부양가족수 및 소득 구간별 차등 적용) <br /><span
            class="text-sm text-gray-500"
            >※ 본 계산기는 복잡한 간이세액표를 최대한 단순화하여 적용합니다.
            실제 세금과 차이가 있을 수 있습니다. 정확한 세금은 국세청 자료를
            참고하세요.</span
          >
        </p>
        <p class="text-gray-700 mb-2 leading-relaxed">
          ✅ <strong class="text-red-600">지방소득세:</strong> 소득세의 10%
        </p>
      </section>

      <!-- Google AdSense 광고 영역 (수익화 고려) -->
      <div class="mt-12 text-center bg-gray-100 p-6 rounded-lg shadow-inner">
        <p class="text-gray-600 text-lg font-semibold mb-4">
          여기에 광고가 표시됩니다 (Google AdSense)
        </p>
        <div
          class="w-full h-32 bg-gray-200 flex items-center justify-center text-gray-500 rounded-md"
        >
          <p>광고 영역</p>
        </div>
        <!-- 추가적인 광고 배치 영역을 고려할 수 있습니다. -->
      </div>
    </main>

    <!-- 푸터 -->
    <footer class="mt-8 text-center text-gray-500 text-sm">
      <p>&copy; 2024 NetPayKorea. 모든 권리 보유.</p>
      <p>
        본 계산 결과는 추정치이며, 실제와 다를 수 있습니다. 정확한 정보는 관련
        기관을 통해 확인해주세요.
      </p>
    </footer>

    <!-- 커스텀 모달 구조 (alert/confirm 대체) -->
    <div
      id="customModal"
      class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300 opacity-0 pointer-events-none"
    >
      <div
        class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4 transform -translate-y-4 transition-transform duration-300"
      >
        <p id="modalMessage" class="text-lg text-gray-800 mb-6 text-center"></p>
        <div class="flex justify-center space-x-4">
          <button
            id="modalConfirmBtn"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md shadow-sm transition duration-300"
          >
            확인
          </button>
          <button
            id="modalCancelBtn"
            class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-md shadow-sm transition duration-300"
          >
            취소
          </button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // DOM 요소 참조
        const annualSalaryInput = document.getElementById("annualSalary");
        const nonTaxableIncomeInput =
          document.getElementById("nonTaxableIncome");
        const dependentsInput = document.getElementById("dependents");
        const calculateBtn = document.getElementById("calculateBtn");

        const displayMonthlyGross = document.getElementById(
          "displayMonthlyGross"
        );
        const displayMonthlyTaxable = document.getElementById(
          "displayMonthlyTaxable"
        );
        const displayMonthlyNonTaxable = document.getElementById(
          "displayMonthlyNonTaxable"
        );
        const displayNationalPension = document.getElementById(
          "displayNationalPension"
        );
        const displayHealthInsurance = document.getElementById(
          "displayHealthInsurance"
        );
        const displayLongTermCare = document.getElementById(
          "displayLongTermCare"
        );
        const displayEmploymentInsurance = document.getElementById(
          "displayEmploymentInsurance"
        );
        const displayIncomeTax = document.getElementById("displayIncomeTax");
        const displayLocalIncomeTax = document.getElementById(
          "displayLocalIncomeTax"
        );
        const displayNetPay = document.getElementById("displayNetPay");

        const scenarioNameInput = document.getElementById("scenarioName");
        const saveScenarioBtn = document.getElementById("saveScenarioBtn");
        const scenarioList = document.getElementById("scenarioList");
        const noScenariosMessage =
          document.getElementById("noScenariosMessage");

        // --- 2024년 기준 상수 (예시 요율) ---
        const NATIONAL_PENSION_RATE = 0.045; // 국민연금 본인 부담분 (총 9%)
        const HEALTH_INSURANCE_RATE = 0.03545; // 건강보험 본인 부담분 (총 7.09%)
        const LONG_TERM_CARE_RATE_OF_HEALTH_INSURANCE = 0.1295; // 장기요양보험 요율 (건강보험료의 12.95%)
        const EMPLOYMENT_INSURANCE_RATE = 0.008; // 고용보험 실업급여 요율 (본인 부담분)

        // 간이 소득세 테이블 (데모를 위한 근사치)
        // 이 테이블은 실제 국세청 간이세액표의 복잡성을 완전히 반영하지 않습니다.
        // 실제 서비스에서는 더 정교한 세금 테이블 구현이 필요합니다.
        // 형식: { min: 월 과세소득 최소값, max: 월 과세소득 최대값, taxRates: [부양가족 1명일 때 세금, 2명일 때 세금, ...] }
        // `taxRates` 배열의 인덱스는 (부양가족수 - 1)에 해당합니다.
        // 예: taxRates[0]은 부양가족 1명 (본인만)일 때의 세금, taxRates[1]은 2명일 때 등.
        const INCOME_TAX_TABLE = [
          { min: 0, max: 2000000, taxRates: [1000, 0, 0, 0, 0, 0] },
          {
            min: 2000001,
            max: 3000000,
            taxRates: [30000, 20000, 10000, 5000, 0, 0],
          },
          {
            min: 3000001,
            max: 4000000,
            taxRates: [60000, 45000, 30000, 15000, 7000, 0],
          },
          {
            min: 4000001,
            max: 5000000,
            taxRates: [100000, 80000, 60000, 40000, 20000, 10000],
          },
          {
            min: 5000001,
            max: 6000000,
            taxRates: [150000, 120000, 90000, 60000, 30000, 15000],
          },
          {
            min: 6000001,
            max: Infinity,
            taxRates: [200000, 160000, 120000, 80000, 50000, 30000],
          },
        ];

        /**
         * 월 과세 소득과 부양가족수에 따라 예상 월 소득세를 계산합니다.
         * @param {number} monthlyTaxableIncome - 과세 대상 월 소득.
         * @param {number} dependents - 부양가족수 (본인 포함).
         * @returns {number} 예상 월 소득세.
         */
        function getIncomeTax(monthlyTaxableIncome, dependents) {
          let incomeTax = 0;
          // 부양가족수를 taxRates 배열 인덱스에 맞게 조정 (예: 1명 -> 인덱스 0)
          // 단순화된 테이블에 대한 범위 초과 방지를 위해 부양가족수를 제한합니다.
          const effectiveDependentsIndex = Math.max(
            0,
            Math.min(dependents, INCOME_TAX_TABLE[0].taxRates.length) - 1
          );

          for (const range of INCOME_TAX_TABLE) {
            if (
              monthlyTaxableIncome >= range.min &&
              monthlyTaxableIncome <= range.max
            ) {
              // 해당 부양가족수 인덱스에 해당하는 세금율 적용
              incomeTax = range.taxRates[effectiveDependentsIndex] || 0;
              break;
            }
          }
          return incomeTax;
        }

        /**
         * 숫자를 한화 통화 형식으로 포맷합니다.
         * @param {number} amount - 포맷할 금액.
         * @returns {string} 포맷된 통화 문자열 (예: "₩1,234,567").
         */
        function formatCurrency(amount) {
          return new Intl.NumberFormat("ko-KR", {
            style: "currency",
            currency: "KRW",
          }).format(amount);
        }

        /**
         * 현재 입력 값으로 실수령액을 계산하고 결과를 표시합니다.
         * @returns {object|null} 계산된 모든 값을 포함하는 객체, 또는 입력이 유효하지 않은 경우 null.
         */
        function calculateNetPay() {
          const annualSalary = parseFloat(annualSalaryInput.value || 0);
          const nonTaxableIncome = parseFloat(nonTaxableIncomeInput.value || 0);
          const dependents = parseInt(dependentsInput.value || 1);

          // 입력 유효성 검사 및 오류 메시지 (커스텀 모달 사용)
          if (annualSalary <= 0 || isNaN(annualSalary)) {
            showModal("연봉을 올바르게 입력해주세요.", "alert");
            return null;
          }
          if (nonTaxableIncome < 0 || isNaN(nonTaxableIncome)) {
            showModal("비과세 소득을 올바르게 입력해주세요.", "alert");
            return null;
          }
          if (dependents < 1 || isNaN(dependents)) {
            showModal("부양가족수는 1명 이상이어야 합니다.", "alert");
            return null;
          }

          const monthlyGrossSalary = annualSalary / 12;
          const monthlyNonTaxable = nonTaxableIncome;
          // 월 과세 대상 급여 = 총 월 급여 - 월 비과세 소득
          const monthlyTaxableSalary = monthlyGrossSalary - monthlyNonTaxable;

          // 4대 보험 계산
          let nationalPension = monthlyTaxableSalary * NATIONAL_PENSION_RATE;
          // 국민연금 기준소득월액 상한액 적용 (2024년 기준 590만원)
          const NATIONAL_PENSION_MAX_MONTHLY_BASE = 5900000;
          if (monthlyTaxableSalary > NATIONAL_PENSION_MAX_MONTHLY_BASE) {
            nationalPension =
              NATIONAL_PENSION_MAX_MONTHLY_BASE * NATIONAL_PENSION_RATE;
          }
          nationalPension = Math.round(nationalPension); // 원 단위로 반올림

          const healthInsurance = Math.round(
            monthlyTaxableSalary * HEALTH_INSURANCE_RATE
          );
          const longTermCareInsurance = Math.round(
            healthInsurance * LONG_TERM_CARE_RATE_OF_HEALTH_INSURANCE
          );
          const employmentInsurance = Math.round(
            monthlyTaxableSalary * EMPLOYMENT_INSURANCE_RATE
          );

          // 소득세 및 지방소득세
          const incomeTax = Math.round(
            getIncomeTax(monthlyTaxableSalary, dependents)
          );
          const localIncomeTax = Math.round(incomeTax * 0.1);

          // 총 공제액
          const totalDeductions =
            nationalPension +
            healthInsurance +
            longTermCareInsurance +
            employmentInsurance +
            incomeTax +
            localIncomeTax;

          // 실수령액
          const netMonthlyPay = monthlyGrossSalary - totalDeductions;

          // 결과 표시
          displayMonthlyGross.textContent = formatCurrency(monthlyGrossSalary);
          displayMonthlyTaxable.textContent =
            formatCurrency(monthlyTaxableSalary);
          displayMonthlyNonTaxable.textContent =
            formatCurrency(monthlyNonTaxable);
          displayNationalPension.textContent = formatCurrency(nationalPension);
          displayHealthInsurance.textContent = formatCurrency(healthInsurance);
          displayLongTermCare.textContent = formatCurrency(
            longTermCareInsurance
          );
          displayEmploymentInsurance.textContent =
            formatCurrency(employmentInsurance);
          displayIncomeTax.textContent = formatCurrency(incomeTax);
          displayLocalIncomeTax.textContent = formatCurrency(localIncomeTax);
          displayNetPay.textContent = formatCurrency(netMonthlyPay);

          return {
            annualSalary,
            nonTaxableIncome,
            dependents,
            monthlyGrossSalary,
            monthlyTaxableSalary,
            monthlyNonTaxable,
            nationalPension,
            healthInsurance,
            longTermCareInsurance,
            employmentInsurance,
            incomeTax,
            localIncomeTax,
            netMonthlyPay,
          };
        }

        // --- 커스텀 모달 구현 ---
        /**
         * 커스텀 모달을 표시합니다.
         * @param {string} message - 모달에 표시할 메시지.
         * @param {string} type - 모달 타입 ('alert' 또는 'confirm').
         * @param {function} onConfirmCallback - 'confirm' 타입일 때 확인 버튼 클릭 시 호출될 콜백 함수.
         */
        function showModal(message, type = "alert", onConfirmCallback = null) {
          let modal = document.getElementById("customModal");
          const modalMessage = document.getElementById("modalMessage");
          const modalConfirmBtn = document.getElementById("modalConfirmBtn");
          const modalCancelBtn = document.getElementById("modalCancelBtn");

          modalMessage.textContent = message;

          if (type === "confirm") {
            modalCancelBtn.style.display = "inline-block"; // 취소 버튼 표시
            modalConfirmBtn.onclick = () => {
              hideModal();
              if (onConfirmCallback) onConfirmCallback(true); // 확인 시 true 전달
            };
            modalCancelBtn.onclick = () => {
              hideModal();
              if (onConfirmCallback) onConfirmCallback(false); // 취소 시 false 전달
            };
          } else {
            // 'alert' 타입
            modalCancelBtn.style.display = "none"; // 취소 버튼 숨김
            modalConfirmBtn.onclick = () => {
              hideModal();
              if (onConfirmCallback) onConfirmCallback(); // 콜백만 호출
            };
          }

          // 모달 표시 애니메이션
          modal.classList.remove("opacity-0", "pointer-events-none");
          modal.querySelector("div").classList.remove("-translate-y-4");
        }

        /**
         * 커스텀 모달을 숨깁니다.
         */
        function hideModal() {
          const modal = document.getElementById("customModal");
          if (modal) {
            // 모달 숨김 애니메이션
            modal.querySelector("div").classList.add("-translate-y-4");
            modal.classList.add("opacity-0", "pointer-events-none");
          }
        }

        // --- 시나리오를 위한 로컬 스토리지 기능 ---
        /**
         * 현재 계산된 결과를 시나리오로 로컬 스토리지에 저장합니다.
         */
        function saveScenario() {
          const scenarioName = scenarioNameInput.value.trim();
          if (!scenarioName) {
            showModal("시나리오 이름을 입력해주세요.", "alert");
            return;
          }

          const calculationResult = calculateNetPay();
          if (!calculationResult) {
            // 유효하지 않은 입력으로 계산 실패 시
            showModal(
              "유효한 계산 결과가 없습니다. 연봉을 올바르게 입력해주세요.",
              "alert"
            );
            return;
          }

          let scenarios = JSON.parse(
            localStorage.getItem("netPayScenarios") || "[]"
          );

          // 고유성과 정렬을 위해 현재 타임스탬프 추가
          const newScenario = {
            name: scenarioName,
            timestamp: new Date().toISOString(),
            ...calculationResult,
          };

          // 동일한 이름의 시나리오가 이미 존재하는지 확인
          const existingIndex = scenarios.findIndex(
            (s) => s.name === scenarioName
          );
          if (existingIndex > -1) {
            // 기존 시나리오 업데이트
            scenarios[existingIndex] = newScenario;
            showModal(
              `'${scenarioName}' 시나리오가 업데이트되었습니다.`,
              "alert"
            );
          } else {
            // 새 시나리오 추가
            scenarios.push(newScenario);
            showModal(`'${scenarioName}' 시나리오가 저장되었습니다.`, "alert");
          }

          localStorage.setItem("netPayScenarios", JSON.stringify(scenarios));
          scenarioNameInput.value = ""; // 입력 필드 초기화
          renderScenarios(); // 목록 다시 렌더링
        }

        /**
         * 저장된 시나리오를 계산기 입력 필드로 불러오고 계산을 수행합니다.
         * @param {number} index - 시나리오 배열 내의 인덱스.
         */
        function loadScenario(index) {
          const scenarios = JSON.parse(
            localStorage.getItem("netPayScenarios") || "[]"
          );
          if (index >= 0 && index < scenarios.length) {
            const scenario = scenarios[index];
            annualSalaryInput.value = scenario.annualSalary;
            nonTaxableIncomeInput.value = scenario.nonTaxableIncome;
            dependentsInput.value = scenario.dependents;
            calculateNetPay(); // 다시 계산 및 표시
            scenarioNameInput.value = scenario.name; // 시나리오 이름 입력 필드에 채우기
            window.scrollTo({ top: 0, behavior: "smooth" }); // 페이지 상단으로 스크롤
          }
        }

        /**
         * 로컬 스토리지에서 시나리오를 삭제합니다.
         * @param {number} index - 삭제할 시나리오의 인덱스.
         */
        function deleteScenario(index) {
          showModal(
            "정말로 이 시나리오를 삭제하시겠습니까?",
            "confirm",
            (result) => {
              if (result) {
                // 사용자가 확인을 눌렀을 경우
                let scenarios = JSON.parse(
                  localStorage.getItem("netPayScenarios") || "[]"
                );
                scenarios.splice(index, 1); // 해당 인덱스의 시나리오 삭제
                localStorage.setItem(
                  "netPayScenarios",
                  JSON.stringify(scenarios)
                );
                renderScenarios(); // 목록 다시 렌더링
                showModal("시나리오가 삭제되었습니다.", "alert");
              }
            }
          );
        }

        /**
         * 저장된 시나리오 목록을 렌더링합니다.
         */
        function renderScenarios() {
          const scenarios = JSON.parse(
            localStorage.getItem("netPayScenarios") || "[]"
          );
          scenarioList.innerHTML = ""; // 현재 목록 지우기

          if (scenarios.length === 0) {
            noScenariosMessage.style.display = "block"; // 시나리오 없음 메시지 표시
          } else {
            noScenariosMessage.style.display = "none"; // 메시지 숨김
            // 최신순으로 시나리오 정렬
            scenarios.sort(
              (a, b) => new Date(b.timestamp) - new Date(a.timestamp)
            );

            scenarios.forEach((scenario, index) => {
              const scenarioCard = document.createElement("div");
              scenarioCard.className =
                "bg-white p-4 rounded-md shadow-sm border border-gray-200 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3";
              scenarioCard.innerHTML = `
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg">${
                                  scenario.name
                                }</h4>
                                <p class="text-sm text-gray-600">
                                    연봉: ${formatCurrency(
                                      scenario.annualSalary
                                    )} |
                                    월 실수령: <span class="font-semibold text-blue-700">${formatCurrency(
                                      scenario.netMonthlyPay
                                    )}</span>
                                </p>
                                <p class="text-xs text-gray-500 mt-1">저장일: ${new Date(
                                  scenario.timestamp
                                ).toLocaleDateString("ko-KR")} ${new Date(
                scenario.timestamp
              ).toLocaleTimeString("ko-KR")}</p>
                            </div>
                            <div class="flex flex-row gap-2">
                                <button data-index="${index}" class="load-scenario-btn bg-blue-500 hover:bg-blue-600 text-white text-sm font-semibold py-2 px-3 rounded-md transition duration-300">불러오기</button>
                                <button data-index="${index}" class="delete-scenario-btn bg-red-500 hover:bg-red-600 text-white text-sm font-semibold py-2 px-3 rounded-md transition duration-300">삭제</button>
                            </div>
                        `;
              scenarioList.appendChild(scenarioCard);
            });

            // 새로 생성된 버튼에 이벤트 리스너 연결
            document
              .querySelectorAll(".load-scenario-btn")
              .forEach((button) => {
                button.addEventListener("click", (event) => {
                  loadScenario(parseInt(event.target.dataset.index));
                });
              });
            document
              .querySelectorAll(".delete-scenario-btn")
              .forEach((button) => {
                button.addEventListener("click", (event) => {
                  deleteScenario(parseInt(event.target.dataset.index));
                });
              });
          }
        }

        // 이벤트 리스너 등록
        calculateBtn.addEventListener("click", calculateNetPay);
        saveScenarioBtn.addEventListener("click", saveScenario);

        // 입력 필드 변경 시 자동 계산 (선택 사항: 복잡한 계산에는 비효율적일 수 있으나, 즉각적인 피드백을 위해 적용)
        annualSalaryInput.addEventListener("input", () => {
          if (annualSalaryInput.value.trim() !== "") calculateNetPay();
        });
        nonTaxableIncomeInput.addEventListener("input", () => {
          if (nonTaxableIncomeInput.value.trim() !== "") calculateNetPay();
        });
        dependentsInput.addEventListener("input", () => {
          if (dependentsInput.value.trim() !== "") calculateNetPay();
        });

        // 초기 시나리오 로드 및 계산
        renderScenarios();
        // 페이지 로드 시 초기 값으로 계산 수행 (연봉 입력 필드가 비어있지 않은 경우에만 기본값 설정)
        if (!annualSalaryInput.value) {
          annualSalaryInput.value = 40000000; // 예시 기본 연봉 설정
        }
        calculateNetPay(); // 초기 계산 수행
      });
    </script>
  </body>
</html>
